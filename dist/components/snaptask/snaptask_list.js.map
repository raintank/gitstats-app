{"version":3,"sources":["../../../src/components/snaptask/snaptask_list.js"],"names":[],"mappings":"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","file":"snaptask_list.js","sourcesContent":["\nfunction slugify(str) {\n\tvar slug = str.replace(\"@\", \"at\").replace(\"&\", \"and\").replace(\".\", \"_\").replace(\"/\\W+/\", \"\");\n\treturn slug;\n}\n\nclass SnapTaskListCtrl {\n  constructor($scope, $injector, backendSrv, alertSrv) {\n  \tthis.backendSrv = backendSrv;\n    this.alertSrv = alertSrv;\n    this.pageReady = false;\n    this.tasks = [];\n\n    this.getTasks();\n  }\n\n  getTasks() {\n    var self = this;\n    return this.backendSrv.get(\"api/plugin-proxy/raintank-gitstats-app/tasks\", {metric: \"/raintank/apps/gitstats/*\"})\n    .then((resp) => {\n      self.tasks = resp.body;\n\t\t\tself.pageReady = true;\n    });\n  }\n\n  removeTask(task) {\n  \tvar self = this;\n    return this.backendSrv.delete(\"api/plugin-proxy/raintank-gitstats-app/tasks/\"+task.id).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to delete task\", resp, 'error', 10000);\n      }\n      self.getTasks();\n    });\n  }\n\n  stopTask(task) {\n    var self = this;\n  \ttask.enabled = false;\n    return this.backendSrv.put(\"api/plugin-proxy/raintank-gitstats-app/tasks\", task).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to stop task\", resp, 'error', 10000);\n        self.getTasks();\n      }\n    });\n  }\n  startTask(task) {\n    var self = this;\n  \ttask.enabled = true;\n    return this.backendSrv.put(\"api/plugin-proxy/raintank-gitstats-app/tasks\", task).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to start task\", resp, 'error', 10000);\n        self.getTasks();\n      }\n    });\n  }\n\n  taskDashboard(task) {\n  \tvar type =this.getType(task)\n  \tif ( type === \"monitoringJob\") {\n  \t\treturn \"dashboard/db/gitstats-user?&var-monitor=\" + slugify(task.config['/raintank/apps/gitstats'].user);\n  \t} else if (type == \"zone\") {\n  \t\treturn \"dashboard/db/gitstats-repo?&var-zone=\" + slugify(task.config['/raintank/apps/gitstats'].repo);\n  \t}\n  }\n\n  taskLabel(task) {\n  \tvar user = task.config['/raintank/apps/gitstats'].user;\n    if (user === \"\") {\n      user = \"*\";\n    }\n    var repo = task.config['/raintank/apps/gitstats'].repo;\n    if (repo === \"\") {\n      repo = \"*\";\n    }\n    return \"Github Stats: \"+user+\"/\"+repo\n  }\n}\n\nSnapTaskListCtrl.templateUrl = 'public/plugins/raintank-gitstats-app/components/snaptask/partials/snaptask_list.html';\nexport {SnapTaskListCtrl};\n"]}